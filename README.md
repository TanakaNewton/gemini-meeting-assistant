## 音声文字起こしツール ローカル実行手順書 (Windows PC向け)

この手順書は、配布された音声文字起こしツールの **ZIPファイル (`my-transcription-app.zip`など)** を受け取り、お使いのWindowsパソコンで使えるようにするための手順を説明します。

**はじめに**

*   このツールを使うと、お手持ちの音声ファイルをアップロードし、GoogleのGemini AI を使って文字起こしを行い、結果を編集したりCSVファイルとしてダウンロードしたりできます。
*   **特別なプログラミング知識は不要です。**手順に沿って操作すれば利用できます。
*   **必要なもの:**
    *   インターネットに接続されたWindowsパソコン
    *   配布された**ツールのZIPファイル** (`my-transcription-app.zip` 等)
    *   **ご自身の Google Gemini API キー** (取得方法は後述しますが、取得・管理は自己責任となります)

**注意:**

*   このツールは Google の Gemini API を利用します。APIキーの利用には Google の利用規約が適用されます。
*   **APIの利用量によっては、ご自身のGoogleアカウントに関連付けられた料金が発生する可能性があります。** 無料枠もありますが、超過した場合は課金される場合がありますのでご注意ください。利用料金については Google Cloud のドキュメント等をご確認ください。

---

**ステップ1: Node.js のインストール**

まず、アプリケーションを実行するために必要な「Node.js」というソフトウェアをインストールします。(すでにインストール済みの場合はこのステップをスキップできます)

1.  **Node.js 公式サイトを開く:**
    ウェブブラウザで以下のURLを開きます。
    [https://nodejs.org/](https://nodejs.org/)
2.  **LTS版をダウンロード:**
    トップページに表示されている「**LTS**」と書かれたバージョン（推奨版）のインストーラーをダウンロードします。Windows用のインストーラー (`.msi` ファイル) がダウンロードされるはずです。
3.  **インストーラーを実行:**
    ダウンロードした `.msi` ファイルを開き、画面の指示に従ってインストールを進めます。「Next」や「I accept the terms in the License Agreement」にチェックを入れて「Next」、「Install」などをクリックしていけば完了します。特別な設定変更は不要です。
4.  **インストール確認 (任意):**
    インストールが完了したら、正しくインストールされたか確認できます。
    *   スタートメニューを開き、「cmd」と入力して「**コマンド プロンプト**」を検索し、起動します。
    *   起動した黒い画面（コマンドプロンプト）で、以下のコマンドを1行ずつ入力し、それぞれEnterキーを押します。
        ```bash
        node -v
        ```
        ```bash
        npm -v
        ```    `v18.x.x` や `v9.x.x` のようなバージョン番号が表示されれば、正常にインストールされています。確認できたら、この黒い画面は一旦閉じて構いません。

---

**ステップ2: アプリケーションファイルの準備**

1.  **ZIPファイルの保存:** 配布された**ツールのZIPファイル**（例: `my-transcription-app.zip`）を、パソコン内のわかりやすい場所（例: デスクトップ、ドキュメントフォルダなど）に保存します。
2.  **ZIPファイルの展開:** 保存したZIPファイルを**右クリック**し、「**すべて展開...**」を選びます。「展開」ボタンをクリックすると、ZIPファイルと同じ場所に `my-transcription-app` という名前のフォルダ（またはZIPファイル名と同じ名前のフォルダ）が作成されます。
    *   **重要:** この作成された `my-transcription-app` フォルダの場所を覚えておいてください。（例: デスクトップ上、ドキュメントフォルダ内など）

---

**ステップ3: アプリケーションのセットアップ**

アプリケーションを実行するために必要な追加ファイルをインストールします。

1.  **コマンド プロンプトの起動:**
    スタートメニューを開き、「cmd」と入力して「**コマンド プロンプト**」を起動します。
2.  **アプリケーションフォルダへの移動:**
    起動した黒い画面で、ステップ2で展開した `my-transcription-app` フォルダに移動する必要があります。`cd` というコマンドを使います。
    *   **例1: デスクトップに展開した場合**
        ```bash
        cd Desktop\my-transcription-app
        ```
    *   **例2: ドキュメントフォルダに展開した場合**
        ```bash
        cd Documents\my-transcription-app
        ```
    *   （もしユーザー名が必要な場合: `cd C:\Users\YourUsername\Desktop\my-transcription-app` のように入力します。実際の場所に合わせて変更してください）
    *   **簡単な方法:** エクスプローラーで `my-transcription-app` フォルダを開き、上部のアドレスバーをクリックしてパス全体をコピーします。次に、コマンドプロンプトに `cd `（cdの後ろに半角スペース）を入力し、その後ろで**右クリック**するとコピーしたパスが貼り付けられます。そのままEnterキーを押します。
3.  **必要なファイルのインストール (`npm install`):**
    正しく `my-transcription-app` フォルダに移動できたら（黒い画面の表示が `...\my-transcription-app>` のようになります）、以下のコマンドを入力してEnterキーを押します。
    ```bash
    npm install
    ```
    インターネットから必要なファイルがダウンロード・インストールされます。完了まで数分かかる場合があります。エラーメッセージが表示されず、入力待ちの状態に戻れば成功です。（`WARN` というメッセージは無視して構いません）。
    **この `npm install` は、最初にツールをセットアップするときに一度だけ行えばOKです。**

---

**ステップ4: アプリケーションの起動**

1.  **起動コマンドの実行:**
    ステップ3と同じコマンドプロンプト（`my-transcription-app` フォルダにいる状態）で、以下のコマンドを入力してEnterキーを押します。
    ```bash
    npm run dev
    ```
2.  **起動の確認:**
    しばらく待つと、画面に `VITE vX.X.X ready in XXXms` のようなメッセージと、以下のようなURLが表示されるはずです。
    ```
      ➜  Local:   http://localhost:5173/
    ```
    （ポート番号 `5173` は異なる場合があります）
    このURLが表示されていれば、アプリケーションの起動は成功です。**このコマンドプロンプト（黒い画面）は、アプリケーションを使用している間は開いたままにしておいてください。**

---

**ステップ5: アプリケーションの使い方**

1.  **ブラウザでアクセス:**
    ウェブブラウザ（Google Chrome, Microsoft Edge, Firefox など）を開き、ステップ4で表示された `http://localhost:xxxx` のURLをアドレスバーに入力してアクセスします。
2.  **ツールの画面表示:** 音声文字起こしツールの画面が表示されます。
3.  **APIキーの入力:**
    *   画面上部にある「Gemini API Key」の入力欄に、**ご自身で取得した有効な Gemini API キー** を入力してください。入力内容は●で隠れます。
    *   **APIキーの取得方法 (参考):** Google AI Studio ([https://aistudio.google.com/app/apikey?hl=ja](https://aistudio.google.com/app/apikey?hl=ja)) などで取得できます。Googleアカウントが必要です。手順に従ってキーを作成してください。
    *   **【重要】APIキーの管理は自己責任です。他人に教えたり、安全でない場所に保存したりしないでください。**
    *   **【重要】前述の通り、API利用量に応じて料金が発生する可能性があります。ご自身の責任で利用状況をご確認ください。**
4.  **モデルの選択:**
    APIキー入力欄の右隣にある「モデルを選択」ドロップダウンから、利用したいAIモデルを選びます。通常は「Gemini 1.5 Pro (Latest)」などが無料枠でも利用しやすいですが、キーによっては使えないモデルもあります。
5.  **音声ファイルの選択:**
    *   画面中央の大きな点線エリアに、文字起こししたい音声ファイル（MP3, WAVなど）をドラッグ＆ドロップします。
    *   または、エリア内の「ファイルを選択」ボタンをクリックしてファイルを選びます。
    *   ファイルを選択すると、ファイル名とサイズが表示され、文字起こしボタンが押せるようになります。
    *   間違ったファイルを選んだ場合は、ファイル名の横にある「×」ボタンでクリアできます。
6.  **文字起こし開始:**
    ファイル選択後に表示される「文字起こし開始」ボタン（選択ファイル名の右側）をクリックします。処理が始まると「処理中...」と進捗メッセージが表示されます。完了まで音声ファイルの長さやネットワーク状況によって時間がかかります。
7.  **結果の確認と編集:**
    *   処理が完了すると、画面下部に結果がテーブル形式で表示されます。
    *   **話者名の一括編集:** テーブルの上にある「話者名の一括編集」セクションで、「話者A」などのデフォルト名に対する新しい名前を入力し、「一括変更を適用」ボタンを押すと、テーブル内の該当する話者名が一斉に変わります。
    *   **個別編集:** テーブル内の「話者」または「発言内容」のセルをクリックすると、入力欄に変わり、直接編集できます。編集後、Enterキーを押すか、入力欄の外側をクリックすると保存されます。Escキーでキャンセルできます。（発言内容の編集ではShift+Enterで改行できます）
8.  **CSVダウンロード:**
    文字起こし完了後、画面上部のモデル選択ドロップダウンの右隣に「CSVダウンロード」ボタンが表示されます。クリックすると、編集後の内容がCSVファイルとしてダウンロードされます。（通常は「ダウンロード」フォルダに保存されます）

---

**ステップ6: アプリケーションの終了**

1.  **ブラウザを閉じる:** アプリケーションを使っていたウェブブラウザのタブまたはウィンドウを閉じます。
2.  **サーバーの停止:** アプリケーションを起動したままにしておいたコマンドプロンプト（黒い画面）を選択し、キーボードの `Ctrl` キーを押しながら `C` キーを押します。「バッチ ジョブを終了しますか (Y/N)?」と表示されたら `Y` キーを押して Enter キーを押すと、サーバーが停止し、元の入力待ち状態に戻ります。これで完全に終了です。

---

**困ったときは**

*   **コマンドが見つからないエラーが出る ('node' は～認識されていません。など):** Node.js が正しくインストールされていない可能性があります。ステップ1から確認してください。インストール後、PCの再起動が必要な場合もあります。
*   **`npm install` でエラーが出る:** インターネット接続を確認してください。また、`my-transcription-app` フォルダのパスに日本語や特殊文字が含まれていないか確認してください。
*   **`npm run dev` でエラーが出る:** `npm install` が正常に完了しているか確認してください。コマンドプロンプトを一度閉じて、再度ステップ3-1から（フォルダ移動から）やり直してみてください。
*   **ブラウザで画面が表示されない、またはエラーが出る:** コマンドプロンプトにエラーメッセージが表示されていないか確認してください。URL（`http://localhost:xxxx`）が正しいか確認してください。
*   **文字起こしでエラーが出る:** APIキーが正しいか、有効期限が切れていないか確認してください。選択したモデルがそのAPIキーで利用可能か確認してください（無料枠で使えないモデルもあります）。インターネット接続を確認してください。

上記で解決しない場合は、ツールの配布元にお問い合わせください。